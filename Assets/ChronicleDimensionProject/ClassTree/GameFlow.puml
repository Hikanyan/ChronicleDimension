@startuml
title ゲームの全体的な流れ

start

:ログイン;

if (初回ログインまたは日付変更?) then (はい)
    :ログインボーナス表示;
    :報酬受取(経験値&コインorアイテム);
else (いいえ)
endif

:リズムゲームスタミナ表示;
:アクションゲームスタミナ表示;

:ゲーム選択;

if (音量設定?) then (はい)
    :音量調整;
else (いいえ)
endif

split 
    :リズムゲーム選択;

    if (ノーツの速さ設定?) then (はい)
        :ノーツの速さ調整;
    else (いいえ)
    endif
    
    if (消費スタミナ選択) then (はい)
        if (スタミナが足りている?) then (はい)
            :スタミナ消費を設定;
        else (いいえ)
            :スタミナ購入を促進;
            if (スタミナを購入?) then (はい)
                :スタミナ購入;
                :スタミナ消費を設定;
            else (いいえ)
            endif
        endif
    else (いいえ)
        
    endif

    if (オンライン対戦?) then (はい)
        :オンラインマッチメイキング;
    else (いいえ)
    endif

    :楽曲選択;
    :ゲーム開始;

    if (スタミナが足りている?) then (はい)
        :設定したスタミナ消費;
        :ゲームスタート;
    else (いいえ)
        :ゲームスタート（報酬低下）;
    endif

    :リザルト;
    :スタミナに応じて報酬受取(経験値&コイン);

split again
    :アクションゲーム選択;

    

    if (消費スタミナ選択) then (はい)
        if (スタミナが足りている?) then (はい)
            :スタミナ消費を設定;
        else (いいえ)
            :スタミナ購入を促進;
            if (スタミナを購入?) then (はい)
                :スタミナ購入;
                :スタミナ消費を設定;
            else (いいえ)
            endif
        endif
    else (いいえ)
    endif
    
    if (オンライン対戦?) then (はい)
        :オンラインマッチメイキング;
    else (いいえ)
    endif

    :ステージ選択;
    :ゲーム開始;
    
    if (スタミナが足りている?) then (はい)
        :設定したスタミナ消費;
        :ゲームスタート;
    else (いいえ)
        :ゲームスタート（報酬低下）;
    endif

    :リザルト;
    :スタミナに応じて報酬受取(経験値&コイン);

split again
    :ガチャ選択;
    :ガチャの説明と価格表示;

    if (ガチャを回す?) then (はい)
        :コインまたはジェム消費;
        :ガチャ回転;
        :結果表示;
        :報酬受取(アイテム);
    else (いいえ)
    endif

end split

:プレイヤーのレベルアップ確認;

if (レベルアップ?) then (はい)
    :レベルアップ表示と報酬;
endif

:ゲームメニューに戻る;

stop

@enduml
